！！！每天记得先更新一波代码  防止后期提交发生冲突

！！！ 大小 颜色 边距 



# 剪贴板

```js
 searchs: [{
        type: "dateTimePicker",
        id: "beginDateTime",
        label: "上传开始时间",
        pickerOptions: 'beginDatePicker'

      }, {
        type: "dateTimePicker",
        id: "endDateTime",
        label: "上传结束时间",
        pickerOptions: 'endDatePicker'
      }, {
```



# 考试管理系统（PC端）

## 进度

- [x] PC端换皮肤
- [x] 移动端换皮肤
- [x] 统计分析页面  布局实现
- [x] 添加生成二维码
- [x] 统计页面布局  字体大小  菜单栏 二级菜单 优化 
- [x] 统计分析页面 功能实现
- [x] pc端考试页面 绿色版
- [x] 布局优化   返回按钮
- [x] 试卷题目选项 A 与选项 不齐
- [x] 添加考试页面  拆分出公共底部栏 
- [x] whiteCard数字 字体样式
- [x] 学生分析  属性后边不加冒号
- [x] 时间选择器样式优化
- [x] statistic页面改善布局 
- [x] 新规范-统计首页

## 分析

**试题分析页面**

循环 饼图 

饼图的数据 series 由  name  value组成  无需配置 xAxias  yAxias

**人员分析页面**

1. 获取所有学生 List, 并初始化 第一个学生的id 
2. 通过id 和 examid 获取该学生的信息 
3. 将图标数据 赋值 给  series[0].data

## 问题

1. echarts中 legend的**formatter** 格式化为 百分比  如: 单选题 5%

   ```js
   			formatter: function(name) {
               var data = option.series[0].data;
               var total = 0;
               var tarValue;
               for (var i = 0, l = data.length; i < l; i++) {
                 total += data[i].value;
                 if (data[i].name == name) {
                   tarValue = data[i].value;
                 }
               }
               var p = ((tarValue / total) * 100).toFixed(2);
               return name + " " + " " + p + "%";
             },
   ```

2. 给 min-width 属性禁用 一般 设 0 而不是none , 因为width是长度单位 

3. localStorage / sessionStorage 存储数据 要先将数据  JSON.stringlfy 化  ，取用数据时 JSON.parse 转换

4. Vue 自带的 删除对象属性  `this.$delete(obj,key)`

5. 当 echarts 数据量少的时候，可以通过这种方式 不用自定义legend 又方便渲染数据

   ```js
    api.get("/statistic/statisticExamTotal").then(res => {
           this.pieChartOptionData.series[0].data = [{
             value: res.notStart,
             name: "未开始  " + res.notStart + '  场'
           },
           {
             value: res.examing,
             name: "进行中  " + res.examing + '  场'
           },
           {
             value: res.finished,
             name: "已结束  " + res.finished + '  场'
           }
           ];
         });
       },
   ```

6. 样式穿透 

   针对于在 scoped 文件中 设置的样式在第三方组件中不生效的问题

   在css中 可以使用  >>>  , 在scss中 可以使用 /deep/ 或者 ::v-deep 来解决 

   注意：/deep/ 不能嵌套使用，否则内部的样式会不生效

7. 防止鼠标多次点击

   ```js
   //防止多次连续点击提交
   Vue.directive('preventReClick', {
     inserted(el, binding) {
       el.addEventListener('click', () => {
         if (!el.disabled) {
           el.disabled = true
           setTimeout(() => {
             el.disabled = false
           }, binding.value || 2000)
         }
       })
     }
   })
   // 使用 
    <el-button v-preventReClick="3000" @click.native="cancel">关闭</el-button>
   ```

8. 同一个页面遍历渲染出多个不同的echarts

   ```js
   <pie-chart
     :chart-option="getEchartData(item)"
     :height="'160px'"
     :width="'160px'"
   />
     
   // 获取数据函数
    getEchartData(data) {
         const config = {   // 基本参数
           grid: {
             top: 0,
             left: 0
           },
           color: ["rgba(0, 169, 124, 1)", "rgba(0, 169, 124, 0.5)", "rgba(0, 169, 124, 0.3)", "rgba(0, 169, 124, 0.2)"],
           tooltip: {
             trigger: "item",
             backgroundColor: "rgba(255,255,255,0.8)", // 通过设置rgba调节背景颜色与透明度
             color: "black",
             borderWidth: "1",
             borderColor: "rgb(156,209,255)",
             textStyle: {
               color: "black"
             },
             formatter: function (params) {
               let html = "<p style='text-align:left;'>" + params.seriesName + "</p>" + "<div>" +
                 "<div style='display: inline-block;width:10px; margin-right: 10px;height: 10px; background: " +
                 params.color +
                 "; border-radius: 50%;'></div>" + params.name + '项' + params.value + '人' + "</div>"
               return html
             }
           },
           series: [
             {
               name: "选项人数",
               type: 'pie',
               radius: ['30%', '70%'],
               minAngle: 30,
               avoidLabelOverlap: false,
               emphasis: {
                 disabled: false,
                 scale: false
               },
               label: {
                 show: true,
                 position: 'inside',
                 color: '#fff',
                 fontSize: 16
   
               },
               data: []
   
             }
           ]
         }
         if (data.prefixStatistic) {      // 给 series中的data赋值 
           if (data.prefixStatistic.length > 0) {
             config.series[0].data = [];
             data.prefixStatistic.forEach(item => {
               let param = {
                 name: item.prefix,
                 value: item.number
               }
               config.series[0].data.push(param)
             })
           }
   
   
         }
   
         return config;
   
       }
      
   
   ```

9. elementUI中 <el-radio-group> 动态展示 

   ```js
    <el-radio-group
         v-if="question.questionTypeId == 'radio' ||
         question.questionTypeId == 'judge'"
         :value="getAnswer(item.correct, question.questionTypeId)"
         >
           <div
         class="selectDiv"
         v-for="(selection, index) in item.questionContent"
         :key="index"
         >
           <el-radio :key="selection.prefix" :label="selection.prefix">
             {{ selection.prefix }}
               <span class="itemCont">{{ selection.content }}</span>
         </el-radio>
         </div>
    </el-radio-group>
   --------------------CSS----------------------------------------
   
      .selectDiv {
        line-height: 50px;
   
        .itemCont {
          /deep/ p {
            display: inline-block;
          }
        }
   
      }
   
      /deep/ .el-radio-group {
        width: 100%;
        overflow: hidden;
        min-height: 200px;
   
        .el-radio {
          span {
            vertical-align: middle;
            white-space: normal;
          }
        }
          
        .el-radio__label {
          width: 100%;
          word-break: normal;
        }
   
      }
   
   ```

10. el-tree 在无checkbox的情况下，**默认选中第一行数据**

    ```js
    // 默认展开的节点数组 
    :default-expanded-keys="currentKey"
    
    // 监听数组 默认click
    watch: {
      
        'currentKey': function (newVal, oldVal) {
          if (newVal) {
            this.$nextTick(() => {
              document.querySelector('.el-tree-node__content').click()
            })
          }
        }
    
      },
    ```

11. 解决 多级连菜单 childList数组为空，但页面  ` el-cascader控件 最后一级出现空白 暂无数据`

    ```js
    // 解决方法： 将空的childList 数组 设置为undefined 
    this.treeData = this.optimizeTreeDate(res.data);
    
    optimizeTreeData(data){
      for(let i=0,i<data.length;i++){
        if(data[i].childList =length <1){
          data[i].childList = undefined ;
        }else{
          this.optimizeTreeData(data[i].childList)
        }
        return data
      }
    }
    
    ```


12. 头部子项目内容过多时以展开折叠形式布局，可以参考el-collapse-transition` 组件实现折叠展开效果。 

13. 防切屏功能的实现

    描述：考试页面不在当前页面就视为切屏一次，超过所允许的切屏次数，则自动交卷
    
    ```js
    // 在 vue的 mounted 钩子中加 页面可见/不可见事件  visibilitychange 
    mounted:{
      window.addEventListener("visibilitychange", this.pageHidden);
    }
    // pageHidden  函数 进行页面检测 
    // isReduce 0扣次数 1不扣次数  router判断是否为路由跳转 
        //切换页面检测
        //isReduce 0扣次数 1不扣次数 router 判断是否为路由转跳
        //事件默认参数
        pageHidden(e = null, isReduce = 0, router = false) {
          return new Promise((resolve, reject) => {
            if (document.visibilityState === "hidden" || router) {
              this.axios({
                method: "post",
                url: "/knowledge/exam/saveSwitchPageCount",
                data: {
                  pkExam: this.testData.pkExam,
                  pkPaper: this.testData.pkPaper,
                  startTime: this.testData.startTime,
                  pkCurExam: this.testData.pkCurExam,
                  isFirst: isReduce,
                  endTime: this.testData.endTime
                }
              }).then(res => {
                let data = res.data;
                if (data.code == "0") {
                  this.switchPage = data.data;
                  //remaTimes 可切片次数大于0
                  if (
                    this.switchPage.remaTimes >= 0 &&
                    !this.isStop &&
                    (this.switchPage.remaTimes != this.switchPage.switchPageTimes ||
                      (this.switchPage.remaTimes != 0 &&
                        this.switchPage.switchPageTimes != 0)) &&
                    this.switchPage.switchPageTimes != 1000
                  ) {
                    this.tipsFlag = true;
                    this.tips = 2;
                  } else if (this.switchPage.remaTimes < 0 && !this.isStop) {
                    this.submitTest();  // 超过次数 进行交卷操作 
                  }
                  resolve();
                } else {
                  reject();
                }
              });
            }
          });
        },
    // 最后要在 destroyed 钩子中取消监听事件  
          destroyed(){
            window.removeEventListener('visibilitychange',this.pageHidden
          }
    ```
    
14. int和integer的基本使用对比 

    * Interger是int的包装类，int是基本数据类型
    * integer变量必须实例化后才能使用，int变量不需要
    * interger实际是对象的引用，指向此new的Interger对象， int是直接存储数据值
    * integer的默认值是null , int的默认值是 0 

    

# 考试管理系统（移动端）

## 进度

- [x] 题目总数的动态展示 
- [x] 主题颜色的改变
  - [x] pc端  首页echarts图表颜色 （不可控制）
  - [x] 考试管理页面 
- [x] 页面弹框显示考试列表信息
- [x] el-message-box样式部署完丢失

## 问题：

1. el-message-box  部署后会样式会被官方样式修改， 通过  **媒体查询**来做移动端适配 解决。

## 总结：

**所作内容的了解：**

考试管理系统  - 移动端   功能点就是： 学生在移动端平台进行 **在线考试** /  **考试查询** 

这个产品是面向于学生群体，那么就应该有两大特点  简洁+高效， 

**基本流程：**学生登录自己的账号然后通过搜索或者从考试列表进入考试，考完试跳转到考试记录进行成绩查询和查看答案解析。

**两周任务 ：**

对登录页面   考试列表页面  考试记录页面  以及 一些考试或者考生信息的弹窗确认页面 的 布局实现和细节优化（flex布局和百分比布局，然后就是基本的操作功能实现。

**遇到的问题：**

1. 思路只局限于ui给的设计稿，忘了用户操作的连贯性。比如查看答题卡页面 ，只是把UI给的图实现了，但是少了进行 上一题/下一题的跳转按钮 。
2. 考试题目多样，有选择题 判断题 填空题 简答题，所以他们的布局是不同的，并不是统一写一个布局就能解决了。 
3. 数据量大的情况，如果采用分页按钮跳转不妥，最后采用了  触底加载更多数据技术 



# 心理健康系统（PC端）

## 需求

~~APP版本管理   新增一个左侧菜单  versionbook~~

~~上传和下载程序包~~ 

~~公共头部 添加一个  职业健康评估 APP~~ 

~~版本号要 大于现有的最大版本号~~  

~~升级内容  有换行 `<br/>`2-200个字~~

~~查看弹窗 只允许查看，不能编辑~~

## 进度

- [x] 发布新版本功能
- [x] 查看功能
- [x] 编辑功能 
- [x] 输入框  infinite 问题
- [x] 头部导航的问题
- [x] 菜单栏样式修改
- [ ] 表格搜索 展开折叠
- [x] 头部最小宽度 / 网页最小宽度
- [x] 模块 一行5个 
- [x] 发布新版本 按钮高度 

## 问题

1. 头部导航栏有一个滑动效果 

   ```js
   // 使用elementUI提供的组件  将要滚动的内容包裹起来
   <el-scrollbar style="height:100%"></el-scrollbar>、
   // 隐藏横向的滚动条
   .el-scrollbar__wrap {
     overflow-x: hidden;
   }
   // 如果要求横向滚动 可以设置 white-space
   .el-scrollbar .el-scrollbar__wrap .el-scrollbar__view{
      white-space: nowrap;
   }
   ```

2. z-index不生效的问题

   在用z-index的时候，该元素没有定位（非static）

   在有定位的情况下，该元素的z-index没有生效，是因为该元素的子元素后来居上，盖住了该元素，解决方式：将盖住该元素的子元素的z-index设置为负数，而该元素不设z-index属性.

3. 如果想让某个盒子不想受窗口大小挤压换行，那就设置 min-width 

4. 前端图片等比例缩放 

   只给图片设置宽度或者高度，浏览器自动缩放

5. 时间选择器 添加判断 结束时间要大于开始时间 (组件化时间选择器)

   ```js
    <el-form-item v-else-if="item.type === 'dateTimePicker'" :prop="item.id" :label="item.label">
                 <el-date-picker v-model="form[item.id]" :type="item.dateType || 'datetime'" :default-time="'23:59:59'"
                   :formate="item.formate || 'yyyy-MM-dd HH:mm'" :value-format="item.valueFormate || 'yyyy-MM-dd HH:mm:ss'"
                   :picker-options="dateOptions[item.pickerOptions] || {}" :placeholder="item.label" style="width:100%"
                   size="small" @input="forceUpdate" />
    </el-form-item>
   ```

   ```js
    dateOptions: {
           beginDatePicker: { //时间选择option
             disabledDate: time => {
               let endDateVal = this.form.endDateTime;
               if (endDateVal) {
                 return time.getTime() > (new Date(endDateVal).getTime());
               }
             }
           },
           endDatePicker: {
             disabledDate: time => {
               let beginDateVal = this.form.beginDateTime;
               if (beginDateVal) {
                 return (
                   time.getTime() < (new Date(beginDateVal).getTime())
                 );
               }
             },
           }
         }
   ```

   



# 用户管理系统

## 进度

- [x] 头部导航栏样式 

## 分析

## 问题

# 问卷调查

## 进度

- [x] 头部导航栏布局
- [x] 侧边菜单
- [x] 表格布局
- [ ] 分页样式重构

## 分析

## 问题





# 登录功能

## input样式美化

```css
outline-style:none  取消外边框
border:0px 边框优化
border-radius 设置边框圆角效果
//设置 input的大小 
padding:7px 0px  用height的话输入框的光标会置于顶部，还要设置其他样式，兼容性不input:focus{} 输入框点击发光效果 
font-size 字体大小 
```

# 1.附录

## 1.1 PC开发规范

### 1.1.1 Vue官方规范

1. **组件名为多个单词，为避免冲突。使用大驼峰写法。**（首字母也要大写）

2. 组件的 Data 必须是一个函数，不能对象

3. props 定义至少需要指定 类型。 

   ```js
   props:{
     status:{
       type:String,
         required:true,
         validator:function(){
           return .. 
         }
           
     }
   }
   ```

4. v-for 中, :key必须写以保证维护内部组件及其子树的状态

5. v-for和v-if 不作用于同一DOM元素

6. 为组件样式作用域  scoped

7. components文件夹下的 组件  使用文件夹分类 

8. 自己创建组件，写 readme

9. 共用组件 只要跨页面  就放在 components

10. 模板中 简单表达式 （组件模板应该只包含简单的表达式，负责的表达式则应该重构为 计算属性 或方法）

11. **组件内 函数命名 采用 小驼峰**  

### 1.1.2 CSS规范

**CSS书写顺序：**

1.位置属性(position, top, right, z-index, display, float等)
2.大小(width, height, padding, margin)
3.文字系列(font, line-height, letter-spacing, color- text-align等)
4.背景(background, border等)
5.其他(animation, transition等)

**尽量使用CSS 缩写属性**

**去掉小数点前的 “0”**

```css
font-size: .8rem
```

**16进制颜色代码缩写** 

**css选择器长名称/词组可以使用  中横线 来命名** 

为选择器添加状态前缀  

### 1.1.2前端自测规范

- 点击可操作性的元素鼠标变手型，可点击的模块要有hover的效果
- 空页面或者空数据的缺省展示，**缺省图片或者空数据显示为 ’-‘**
- 页面更新或者切换时滚动条置顶（如查看政策法规详情，在当前页面进行上一篇或下一篇时）
- 百分比数据显示小数点后2位
- 金额相关，每3位逗号分隔，小数点后显示2位，列表展示右对齐，输入框只能输入数字
- 文字过长时省略号显示 + hover效果（尽量不做折行，表头查询和详情类除外）
- 下载文件时，当文件路径中有中文时需要转义（encodeURI），否则有IE兼容问题
- 组件的样式穿透不能嵌套两层使用（/deep/），里层不会生效（另，/deep/不要写在scss文件中）
- 表单的placeholder自测
- 表单要做通用规则的校验，例如身份证号、手机号等（vue-common中有提供regexp.js的公共正则方法库，欢迎大家补充更新）
- 分开两个组件使用的时间范围，注意规则（开始>结束，结束<开始，日期可以使用组件原生的方法，日期时间的组件不能作用到时分秒，需要手动触发校验规则）
- 列表或表单的呼应数据排列在一起，如起点和终点
- 弹窗表单关闭时，需要置空表单并去掉表单校验
- 表单项如果是input输入框时，做表单首尾空格的非法字符校验
- 列表列宽布局（内容需要有列宽权重）
- 对表格数据进项操作时，需要根据操作不同，对表单进行不同处理。如，增加：表头不重置、分页到第一页并请求；删除：表头不重置、分页到第一页并请求；编辑：表头不重置、分页不更新请求；查询：表头更新、分页到第一页并请求；重置：表头更新、分页到第一个页并请求；
- 删除、发布等危险或需要注意的操作，点击需要加二次确认框，确认用户操作（开发时使用Element的 this.$comfirm命令）
- 带头部查询的列表，头部查询的显示字段要和列表中的字段一致
- 表格头部查询，input输入框类型，查询时，去掉首尾空格（TabelSearch组件已内置处理）

## 1.2 移动端开发规范



## 1.3 提交规范

### 1.3.1 SVN规范

- **type--**具体类型

- **新增：**新需求开发，新特性

- **修改：**需求变更引起的需求修改

- **文档：**文档变更（组件的readme等）

- **样式：**css样式修改，不影响代码逻辑问题

- **重构：**非新需求开发和bug修复性质的代码优化、代码重构等

- **修正：**缺陷修改（测试或自测）

- **对接：**对接数据引起的修改

- **合并**：修改完分支的代码后，合并到主干上时

  例如：

- 新增【运输管理】（客运站信息）：列表及筛选功能的开发及对接

- **合并**【运输管理】（客运站信息）：列表及筛选功能的开发及对接

- 新增【工作台】（工作台首页）：增加了行政审批待办事项

- 修正【交通战备APP】（缺陷编号）：缺陷描述

- 重构【安全监督】（影响路由）：剥离用户权限重构路由

- 对接【PC端领导视图】（高速领导视图）：对接数据接口修改

## 1.4 部署服务器

1. vue项目 prod.dev.js   配置后台服务器 IP地址和 端口号
2. 命令npm run build 生成 dist文件 
3. 使用 finalShell 连接终端服务器 
4. 创建连接 ，输入用户名和密码以及 域名
5. 找到项目文件夹  将 static 和 index.html 删除，并用dist文件替换

## 代码学习

### blob 文件流下载

```js
 exportAssessResult() {
        if (!this.total) {
          this.$message.error('无表单有效反馈结果，无法导出')
          return
        }
        this.$api.get('/factor/exportFactorResult', {
          params: this.queryConditions,
          responseType: 'blob'
        }).then(res => {
          let blob = res
          let downloadElement = document.createElement('a')
          let href = window.URL.createObjectURL(blob) // 创建下载的链接
          downloadElement.href = href
          downloadElement.download = this.projectData.name + "-统计结果" + this.$dayjs().format('YYYYMMDDHHMM') +
            '.xls' // 下载后文件名
          document.body.appendChild(downloadElement)
          downloadElement.click() // 点击下载
          document.body.removeChild(downloadElement) // 下载完成移除元素
          window.URL.revokeObjectURL(href) // 释放掉blob对象
        })
      },
```

