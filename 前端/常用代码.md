## 页面操作

1. 获取当前页面的滚动位置

   ```js
   const getScrollPosition = (el = window) => ({ 
       x: el.pageXOffset !== undefined ? el.pageXOffset : el.scrollLeft, 
       y: el.pageYOffset !== undefined ? el.pageYOffset : el.scrollTop 
   }) 
   getScrollPosition(); // {x: 0, y: 200}
   ```

2. 平滑滚动到页面顶部

   ```js
   const scrollToTop = () => { 
       const c = document.documentElement.scrollTop || document.body.scrollTop 
       if (c > 0) { 
           window.requestAnimationFrame(scrollToTop) 
           window.scrollTo(0, c - c / 8)   //滚动到文档中的某个坐标。(x坐标，y坐标)
       } 
   } 
   scrollToTop()
   ```

3. 确定设备是移动设备还是台式机/笔记本电脑

   ```
   const detectDeviceType = () => 
       /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i
       .test(navigator.userAgent) ? 
       'Mobile' : 'Desktop' 
   detectDeviceType() // "Mobile" or "Desktop"
   ```

4. 禁止选中

   ```html
   // 通过样式来禁止 选中
   body{
     	-moz-user-select: none; /*火狐*/ 
       -webkit-user-select: none; /*webkit浏览器*/ 
       -ms-user-select: none; /*IE10*/ 
       -khtml-user-select: none; /*早期浏览器*/ 
    		 user-select:none 
   }
   
   // 禁止 某个区域 选中操作
   <div onselectstart="return false">
     	此区域禁止复制
    </div>
   ```

   

5. 禁止右键

   ```js
   document.addEventListener('contextmenu', function (e) {
   	e.preventDefault()
   }) 
   ```

   

6. 禁止打开F12 / 控制面板  

   ```js
   window.onkeydown = window.onkeyup=window.onkeypress= function(event){
   		if(event&&event.keyCode === 123){
   				event.preventDefault();
   				window.event.returnValue= false
   		}
   }
   ```

7. 复制文本

   ```js
   function copyPersonURL(content) {
       let that = this
       if (window.ClipboardData) {
         window.clipboardData.setData('text', content)
       } else {
         ;
         (function (content) {
           document.oncopy = function (e) {
             e.clipboardData.setData('text', content)
             e.preventDefault()
             document.oncopy = null
           }
         })(content)
         document.execCommand('Copy')
       }
     }
   ```

8. html转图片

   ```js
   // 安装npm包
   npm install dom-to-image 
   // 引入使用 
   import domtoimage from 'dom-to-image';
   downLoadPhoto () {
     const node = document.getElementById('table')//对应的html标签id
     domtoimage.toPng(node)
       .then((dataUrl) => {
         const img = new Image()
         img.src = dataUrl
         // 将获取到的base64下载下来
         const imgUrl = img.src
         if (window.navigator.msSaveOrOpenBlob) {
           const bstr = atob(imgUrl.split(',')[1])
           let n = bstr.length
           const u8arr = new Uint8Array(n)
           while (n--) {
             u8arr[n] = bstr.charCodeAt(n)
           }
           const blob = new Blob([u8arr])
           window.navigator.msSaveOrOpenBlob(blob, 'chart-download' + '.' + 'png')
         } else {
           // 这里就按照chrome等新版浏览器来处理
           const a = document.createElement('a')
           a.href = imgUrl
           a.setAttribute('download', 'chart-download')
           a.click()
         }
       })
   }
   
   ```

   

## 数据处理

1. 利用map,进行相同属性，数据值合并 

   ```js
   let arr = [{
     name: 'a',
     values: [1, 2]
   }, {
     name: 'b',
     values: [3]
   }, {
     name: 'a',
     values: [4, 5]
   }]
   
   function merge(arr) {
     let newMap = new Map();
     arr.forEach(item => {
       if (newMap[item.name]) {
         newMap[item.name].push(...item.values);
       } else {
         newMap[item.name] = item.values;
       }
     });
     let newArr = [];
     for (let key in newMap) {
       let obj = {
         name: key,
         values: newMap[key]
       }
       newArr.push(obj)
     }
     return newArr
   }
   console.log(merge(arr));
   ```

2. 

   ```
   
   ```

## 时间处理

1. 计算两个日期之间的间隔

   ```js
   const dayDif = (date1, date2) => Math.ceil(Math.abs(date1.getTime() - date2.getTime()) / 86400000)
       
   dayDif(new Date("2021-11-3"), new Date("2022-2-1"))  // 90
   ```

2. 用于将时间转化为 时：分：秒的格式：

   ```
   const timeFromDate = date => date.toTimeString().slice(0, 8);   
   timeFromDate(new Date(2021, 11, 2, 12, 30, 0));  // 12:30:00
   timeFromDate(new Date());  // 返回当前时间 09:00:00
   
   ```

## 封装

### axios的二次封装

新建request.js文件 

```js
/**
 * axios二次封装
 */
import axios from 'axios'
import config from './../config'
import { ElMessage } from 'element-plus'
import router from './../router'
import storage from './storage'

// 创建axios实例对象axios.create （重要），添加全局配置

const service = axios.create({
    baseURL: config.baseApi,   //  http://localhost:3000/admin/
    timeout: 8000
})

// 请求拦截
service.interceptors.request.use((req) => {
  const headers = req.headers;
  const { token = "" } = storage.getItem("userInfo") || {};
  if (!headers.Authorization) headers.Authorization = token;
  return req;
})

// 响应拦截
service.interceptors.response.use((res) => {
    const { code, data, msg } = res.data;
    if (code === 1) {
        return data;
    } else if (code === 801 || code== 802) {
        ElMessage.error("Token认证失败，请重新登录");
        setTimeout(() => {
            router.push('/login')
        }, 1500)
        return Promise.reject("Token认证失败，请重新登录");
    } else {
        ElMessage.error(msg || "网络请求异常，请稍后重试");
        return Promise.reject(msg || "网络络请求异常，请稍后重试");
    }
})
/**
 * 请求核心函数
 * @param {*} options 请求配置
 */
function request(options) {
    options.method = options.method || 'get'
    if (options.method.toLowerCase() === 'get') {
        options.params = options.data;    //  axios 中  get ,post 传值参数格式不同
    }
   service.defaults.baseURL = config.baseApi  //全局
    return service(options)
}

['get', 'post', 'put', 'delete', 'patch'].forEach((item) => {
    request[item] = (url, data, options) => {
        return request({
            url,
            data,
            method: item,
            ...options
        })
    }
})

export default request;

```

页面请求格式： 

```js
  async handleDel(id) {
      await this.$request({url:'/cateSubmit',method:'post',data:{ id, action: "delete" }});
      //await this.$api.menuSubmit({ _id, action: "delete" });
      this.$message.success("删除成功");
      this.getCateList();
    },
```

### storage的二次封装

```js
/**
 * Storage二次封装
 *
 */
import config from './../config'
export default {
    setItem(key, val) {
        let storage = this.getStroage();
        storage[key] = val;
        window.localStorage.setItem(config.namespace, JSON.stringify(storage));
    },
    getItem(key) {
        return this.getStroage()[key]
    },
    getStroage() {
        return JSON.parse(window.localStorage.getItem(config.namespace) || "{}");
    },
    clearItem(key) {
        let storage = this.getStroage()
        delete storage[key]
        window.localStorage.setItem(config.namespace, JSON.stringify(storage));
    },
    clearAll() {
        window.localStorage.clear()
    }
}
```

## CSS

### 自定义scss方法

```scss
// 定义 
@mixin webkit($type, $value) {
    -webkit-#{$type}: $value;
    -moz-#{$type}: $value;
    -o-#{$type}: $value;
    -ms-#{$type}: $value;
    #{$type}: $value;
}
// 使用 
  @include webkit(box-sizing, border-box);
```

### 自定义scss继承属性

```scss
// 定义
%clearfix {
    &:after {
        clear: both;
        content: '.';
        display: block;
        height: 0;
        line-height: 0;
        overflow: hidden;
    }

    *height:1%;
}
// 使用 
@extend %clearfix;
```

### 画一个 ❌ 

```css
 <i class="close" @click="closeCarsInfo"></i>

.close {
      display: block;
      width: 26px;
      height: 26px;
      position: absolute;
      top: 25px;
      right: 0;
      cursor: pointer;

      &:before,
      &:after {
        content: "";
        height: 20px;
        position: absolute;
        top: 50%;
        left: 50%;
        margin-top: -10px;
        margin-left: 1px;
        border-left: 2px solid #999c9f;
      }

      &::before {
        @include webkit(transform, rotate(45deg))
      }

      &::after {
        @include webkit(transform, rotate(-45deg))
      }
    }
```

